<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å—á–µ—Ç —Ä–∞—Ü–∏–æ–Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üçΩÔ∏è –†–∞—Å—á–µ—Ç —Ä–∞—Ü–∏–æ–Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è</h1>
            <p class="subtitle">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞—Ü–∏–æ–Ω–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞—Å—á–µ—Ç–æ–º –ò–ú–¢ –∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞</p>
        </header>

        <main>
            <div class="calculator-section">
                <h2>–†–∞—Å—á–µ—Ç —Ä–∞—Ü–∏–æ–Ω–∞ –ø–∏—Ç–∞–Ω–∏—è</h2>
                
                <div class="controls-section">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patientWeight">–í–µ—Å –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–∫–≥):</label>
                            <input type="number" id="patientWeight" min="0.1" step="0.1" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–µ—Å">
                        </div>
                        <div class="form-group">
                            <label for="patientHeight">–†–æ—Å—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞ (—Å–º):</label>
                            <input type="number" id="patientHeight" min="1" step="0.1" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–æ—Å—Ç">
                        </div>
                        <div class="form-group">
                            <label for="patientAge">–í–æ–∑—Ä–∞—Å—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–ª–µ—Ç):</label>
                            <input type="number" id="patientAge" min="0" step="0.1" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patientGender">–ü–æ–ª:</label>
                            <select id="patientGender">
                                <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                                <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="activityLevel">–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:</label>
                            <select id="activityLevel">
                                <option value="1.2">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (–ª–µ–∂–∞—á–∏–π –±–æ–ª—å–Ω–æ–π)</option>
                                <option value="1.375">–ù–∏–∑–∫–∞—è (—Å–∏–¥—è—á–∏–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏)</option>
                                <option value="1.55" selected>–£–º–µ—Ä–µ–Ω–Ω–∞—è (–ª–µ–≥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)</option>
                                <option value="1.725">–í—ã—Å–æ–∫–∞—è (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è)</option>
                                <option value="1.9">–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏)</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ò–ú–¢ –∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ -->
                    <div class="metabolism-info" id="metabolismInfo" style="display: none;">
                        <div class="info-cards">
                            <div class="info-card">
                                <div class="info-label">–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ (–ò–ú–¢)</div>
                                <div class="info-value" id="bmiValue">-</div>
                                <div class="info-interpretation" id="bmiInterpretation"></div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">–û—Å–Ω–æ–≤–Ω–æ–π –æ–±–º–µ–Ω (–û–û)</div>
                                <div class="info-value" id="bmrValue">-</div>
                                <div class="info-unit">–∫–∫–∞–ª/—Å—É—Ç–∫–∏</div>
                                <div class="info-formula" id="bmrFormula"></div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" id="calculateBtn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–∞—Ü–∏–æ–Ω</button>
                </div>

                <div class="results-section" id="resultsSection" style="display: none;">
                    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h3>
                    <div class="summary-cards">
                        <div class="card">
                            <div class="card-title">–ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å</div>
                            <div class="card-value" id="totalCalories">0</div>
                            <div class="card-unit">–∫–∫–∞–ª/–¥–µ–Ω—å</div>
                        </div>
                        <div class="card">
                            <div class="card-title">–ë–µ–ª–∫–∏</div>
                            <div class="card-value" id="totalProteins">0</div>
                            <div class="card-unit">–≥/–¥–µ–Ω—å</div>
                        </div>
                        <div class="card">
                            <div class="card-title">–ñ–∏—Ä—ã</div>
                            <div class="card-value" id="totalFats">0</div>
                            <div class="card-unit">–≥/–¥–µ–Ω—å</div>
                        </div>
                        <div class="card">
                            <div class="card-title">–£–≥–ª–µ–≤–æ–¥—ã</div>
                            <div class="card-value" id="totalCarbs">0</div>
                            <div class="card-unit">–≥/–¥–µ–Ω—å</div>
                        </div>
                    </div>

                    <div class="diet-plan">
                        <h3>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞—Ü–∏–æ–Ω</h3>
                        <div id="dietTable"></div>
                    </div>

                    <button class="btn btn-secondary" id="exportResultBtn">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Excel</button>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ -->
            <div class="products-search-section">
                <div class="section-header">
                    <h2>–ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</h2>
                    <button class="btn btn-secondary" id="searchMedpitanieBtn">üîç –ü–æ–∏—Å–∫ –Ω–∞ medpitanie.ru</button>
                </div>
                <div class="search-section">
                    <input type="text" id="searchInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞ medpitanie.ru..." class="search-input">
                </div>
                <div id="medpitanieResults" class="medpitanie-results" style="display: none;"></div>
            </div>

            <div class="error-message" id="errorMessage" style="display: none;"></div>
        </main>

        <footer>
            <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è</p>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç</h2>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <input type="hidden" id="productId">
                    <div class="form-group">
                        <label for="productName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ *</label>
                        <input type="text" id="productName" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productCalories">–ö–∞–ª–æ—Ä–∏–∏ (–∫–∫–∞–ª/100–≥) *</label>
                            <input type="number" id="productCalories" min="0" step="0.1" required placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="productProteins">–ë–µ–ª–∫–∏ (–≥/100–≥) *</label>
                            <input type="number" id="productProteins" min="0" step="0.1" required placeholder="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productFats">–ñ–∏—Ä—ã (–≥/100–≥) *</label>
                            <input type="number" id="productFats" min="0" step="0.1" required placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="productCarbs">–£–≥–ª–µ–≤–æ–¥—ã (–≥/100–≥) *</label>
                            <input type="number" id="productCarbs" min="0" step="0.1" required placeholder="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="productDescription">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <textarea id="productDescription" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥—É–∫—Ç–µ"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancelBtn">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="database.js"></script>
    <script src="initialData.js"></script>
    <script src="app.js"></script>
</body>
</html>