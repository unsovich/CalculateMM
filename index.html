<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å—á–µ—Ç —Ä–∞—Ü–∏–æ–Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* –ù–û–í–´–ô –°–¢–ò–õ–¨: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* –°–¢–ò–õ–ò –î–õ–Ø –í–°–¢–†–û–ï–ù–ù–´–• –°–û–û–ë–©–ï–ù–ò–ô */
        .error-message-inline {
            color: #e74c3c;
            font-weight: bold;
        }

        .success-message-inline {
            color: #27ae60;
            font-weight: bold;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .results-table th,
        .results-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .results-table th {
            background-color: #eaf6ff;
            color: #2980b9;
        }

        .results-table .highlight {
            font-weight: bold;
            color: #2c3e50;
            background-color: #f7f7f7;
        }

        @media screen and (max-width: 600px) {
            .results-table thead {
                display: none;
            }

            .results-table,
            .results-table tbody,
            .results-table tr,
            .results-table td {
                display: block;
                width: 100%;
            }

            .results-table tr {
                margin-bottom: 10px;
                border: 1px solid #ccc;
            }

            .results-table td {
                text-align: right;
                padding-left: 50%;
                position: relative;
            }

            .results-table td::before {
                content: attr(data-label);
                position: absolute;
                left: 6px;
                width: 45%;
                padding-right: 10px;
                white-space: nowrap;
                font-weight: bold;
                text-align: left;
                color: #555;
            }

            .results-table .highlight {
                background-color: transparent;
            }
        }

        /* –°–¢–ò–õ–ò: –ù–∞–≥–ª—è–¥–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .results-section {
            padding: 15px 0;
            border-top: 1px solid #eee;
            margin-bottom: 20px;
        }

        .result-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .result-card {
            flex: 1;
            min-width: 280px;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
            border-left: 5px solid #3498db;
        }

        .result-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .result-card h5 {
            margin: 0 0 10px 0;
            font-size: 1em;
            color: #7f8c8d;
            font-weight: 400;
        }

        .metric-value {
            font-size: 2.2em;
            font-weight: 700;
            color: #2c3e50;
            margin: 5px 0;
        }

        .metric-status {
            font-size: 0.9em;
            font-style: italic;
            color: #3498db;
            margin: 0;
        }

        .result-bmi {
            border-left-color: #e74c3c;
        }

        .result-bmr {
            border-left-color: #f39c12;
        }

        .result-daily-need {
            border-left-color: #27ae60;
        }

        .ration-summary-row {
            gap: 15px;
            margin-top: 15px;
            margin-bottom: 5px;
        }

        .ration-summary-card {
            flex: 1;
            min-width: 45%;
            padding: 15px;
        }

        .ration-summary-card h5 {
            font-size: 0.9em;
        }

        .ration-summary-card .small-metric-value {
            font-size: 1.5em;
        }

        .ration-summary-card .metric-status {
            font-size: 1.1em;
            font-weight: 500;
            color: #555;
            font-style: normal;
        }

        .result-portion-powder {
            border-left-color: #9b59b6;
        }

        .result-portion-volume {
            border-left-color: #1abc9c;
        }

        @media screen and (max-width: 900px) {
            .result-row {
                flex-direction: column;
                gap: 10px;
            }

            .result-card,
            .ration-summary-card {
                min-width: 100%;
                flex: none;
            }

            .btn.full-width-mobile {
                width: 100%;
                margin-top: 15px !important;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>üçΩÔ∏è –†–∞—Å—á–µ—Ç —Ä–∞—Ü–∏–æ–Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è</h1>
        </header>

        <main>
            <div class="calculator-section">

                <div class="controls-section">
                    <h2>–î–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patientWeight">–í–µ—Å (–∫–≥):</label>
                            <input type="number" id="patientWeight" min="0.1" step="0.1" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–µ—Å"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="patientHeight">–†–æ—Å—Ç (—Å–º):</label>
                            <input type="number" id="patientHeight" min="1" step="0.1" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–æ—Å—Ç"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="patientAge">–í–æ–∑—Ä–∞—Å—Ç (–ª–µ—Ç):</label>
                            <input type="number" id="patientAge" min="0" step="1" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="patientGender">–ü–æ–ª:</label>
                            <select id="patientGender" required>
                                <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                                <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="activityFactor">–§–∞–∫—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–§–ê):</label>
                            <select id="activityFactor" required>
                                <option value="1.2" selected>1.2 - –ü–æ—Å—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º</option>
                                <option value="1.5">1.5 - –ü–∞–ª–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º (—É–º–µ—Ä–µ–Ω–Ω–∞—è)</option>
                                <option value="1.7">1.7 - –û–±—â–∏–π —Ä–µ–∂–∏–º (–≤—ã—Å–æ–∫–∞—è)</option>
                                <option value="2.0">2.0 - –¢—è–∂–µ–ª–∞—è —Ç—Ä–∞–≤–º–∞ / –°–µ–ø—Å–∏—Å (–º–∞–∫—Å)</option>
                            </select>
                        </div>
                    </div>
                    <div class="results-section">
                        <h4>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h4>
                        <div class="result-row">
                            <div class="result-card result-bmi">
                                <h5>–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ (–ò–ú–¢)</h5>
                                <p id="bmiResult" class="metric-value">0.0 –∫–≥/–º¬≤</p>
                                <p id="bmiStatus" class="metric-status">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ</p>
                            </div>
                            <div class="result-card result-bmr">
                                <h5>–û—Å–Ω–æ–≤–Ω–æ–π –æ–±–º–µ–Ω (–û–û)</h5>
                                <p id="bmrResult" class="metric-value">0 –∫–∫–∞–ª/—Å—É—Ç–∫–∏</p>
                                <p class="metric-status">–§–æ—Ä–º—É–ª–∞ –•–∞—Ä—Ä–∏—Å–∞-–ë–µ–Ω–µ–¥–∏–∫—Ç–∞</p>
                            </div>
                            <div class="result-card result-daily-need">
                                <h5>–°—É—Ç–æ—á–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å (–°–ü)</h5>
                                <p id="dailyNeedResult" class="metric-value" data-daily-need="0">0 –∫–∫–∞–ª/—Å—É—Ç–∫–∏</p>
                                <p id="dailyNeedStatus" class="metric-status">–û–û * –§–∞–∫—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</p>
                            </div>
                        </div>
                    </div>

                    <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Ü–∏–æ–Ω–∞</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="selectedProduct">–°–º–µ—Å—å:</label>
                            <select id="selectedProduct" required>
                                <option value="">-- –ó–∞–≥—Ä—É–∑–∫–∞... --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="concentrationType">–¢–∏–ø —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è:</label>
                            <select id="concentrationType" required>
                                <option value="ordinary">–û–±—ã—á–Ω–æ–µ (1.0 –∫–∫–∞–ª/–º–ª)</option>
                                <option value="hyper">–ì–∏–ø–µ—Ä–∫–∞–ª–æ—Ä–∏—á–µ—Å–∫–æ–µ (1.5 –∫–∫–∞–ª/–º–ª)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="numMeals">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏ (—à—Ç.):</label>
                            <input type="number" id="numMeals" min="1" step="1" value="4" required>
                        </div>
                    </div>
                </div>

                <div id="rationResult" class="result-box">
                </div>

                <button id="searchMedpitanieBtn" class="btn btn-secondary full-width-mobile"
                    style="margin-top: 20px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏</button>
            </div>

            <div class="calculator-section fluid-calculator" style="margin-top: 30px;">
                <h2>üíß –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—É—Ç–æ—á–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –∂–∏–¥–∫–æ—Å—Ç–∏ (–ñ–í–û) –¥–ª—è –¥–µ—Ç–µ–π</h2>

                <div class="controls-section">
                    <p>–†–∞—Å—á–µ—Ç –≤–µ–¥–µ—Ç—Å—è –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Ñ–æ—Ä–º—É–ª–µ **–•–æ–ª–ª–∏–¥–µ—è-–°–µ–≥–∞—Ä–∞** (Holliday-Segar) –Ω–∞ –æ—Å–Ω–æ–≤–µ **–í–µ—Å–∞
                        –ø–∞—Ü–∏–µ–Ω—Ç–∞** –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º—ã.</p>

                    <div class="results-section" id="fluidResult">
                        <div class="result-row" style="justify-content: center;">
                            <div class="result-card result-daily-need" style="flex: 0 0 50%; max-width: 50%;">
                                <h5>–†–∞—Å—á–µ—Ç–Ω—ã–π —Å—É—Ç–æ—á–Ω—ã–π –æ–±—ä–µ–º (–ñ–í–û)</h5>
                                <p class="metric-value" id="totalFluidNeed">0 –º–ª/—Å—É—Ç–∫–∏</p>
                                <p class="metric-status" id="fluidStatus">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –≤–µ—Å–∞</p>
                            </div>
                        </div>
                        <div id="fluidBreakdown"
                            style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #ddd; font-size: 0.9em; text-align: center;">
                        </div>
                    </div>
                </div>
            </div>

            <div id="additionalFluidResult">
            </div>
        </main>
    </div>

    <div id="productModal" class="modal">
        <div class="modal-content" style="max-width: 900px; width: 90%; padding: 25px;">
            <span class="close-btn" id="closeModalBtn">&times;</span>
            <h2 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç</h2>
            <div id="errorMessage" class="error-message" style="display: none;"></div>

            <form id="productForm">
                <input type="hidden" id="productId">

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="productName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ *</label>
                        <input type="text" id="productName" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù—É—Ç—Ä–∏–∑–æ–Ω –≠–¥–≤–∞–Ω—Å—Ç –ü–µ–ø—Ç–∏–∫">
                    </div>
                </div>

                <h3>–°–æ—Å—Ç–∞–≤ (–Ω–∞ 100–≥ —Å—É—Ö–æ–≥–æ –ø–æ—Ä–æ—à–∫–∞)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productCalories">–ö–∞–ª–æ—Ä–∏–∏ (–∫–∫–∞–ª/100–≥) *</label>
                        <input type="number" id="productCalories" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="productProteins">–ë–µ–ª–∫–∏ (–≥/100–≥) *</label>
                        <input type="number" id="productProteins" min="0" step="0.01" required placeholder="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productFats">–ñ–∏—Ä—ã (–≥/100–≥) *</label>
                        <input type="number" id="productFats" min="0" step="0.01" required placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="productCarbs">–£–≥–ª–µ–≤–æ–¥—ã (–≥/100–≥) *</label>
                        <input type="number" id="productCarbs" min="0" step="0.01" required placeholder="0">
                    </div>
                </div>

                <h3>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥—É–∫—Ç–∞</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productScoopWeight">–ú–µ—Ä–Ω–∞—è –ª–æ–∂–∫–∞ (–≥)</label>
                        <input type="number" id="productScoopWeight" min="0" step="0.1" placeholder="–í–µ—Å –º–µ—Ä–Ω–æ–π –ª–æ–∂–∫–∏">
                    </div>
                    <div class="form-group">
                        <label for="productPackageAmount">–ë–∞–Ω–∫–∞ (–≥)</label>
                        <input type="number" id="productPackageAmount" min="0" step="1" placeholder="–í–µ—Å –±–∞–Ω–∫–∏">
                    </div>
                </div>

                <h3>–û–±—ã—á–Ω–æ–µ —Ä–∞–∑–≤–µ–¥–µ–Ω–∏–µ (1.0 –∫–∫–∞–ª/–º–ª)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productScoopsOrdinary">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–∂–µ–∫ (—à—Ç)</label>
                        <input type="number" id="productScoopsOrdinary" min="0" step="0.1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 4">
                    </div>
                    <div class="form-group">
                        <label for="productWaterOrdinary">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–¥—ã (–º–ª)</label>
                        <input type="number" id="productWaterOrdinary" min="0" step="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 85">
                    </div>
                    <div class="form-group">
                        <label for="servingVolume_ordinary">–û–±—ä–µ–º –≥–æ—Ç–æ–≤–æ–π —Å–º–µ—Å–∏ (–º–ª)</label>
                        <input type="number" id="servingVolume_ordinary" step="1" min="0">
                    </div>
                </div>

                <h3>–ì–∏–ø–µ—Ä–∫–∞–ª–æ—Ä–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ–¥–µ–Ω–∏–µ (1.5 –∫–∫–∞–ª/–º–ª)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productScoopsHyper">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–∂–µ–∫ (—à—Ç)</label>
                        <input type="number" id="productScoopsHyper" min="0" step="0.1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 6">
                    </div>
                    <div class="form-group">
                        <label for="productWaterHyper">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–¥—ã (–º–ª)</label>
                        <input type="number" id="productWaterHyper" min="0" step="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 77">
                    </div>
                    <div class="form-group">
                        <label for="servingVolume_hyper">–û–±—ä–µ–º –≥–æ—Ç–æ–≤–æ–π —Å–º–µ—Å–∏ (–º–ª)</label>
                        <input type="number" id="servingVolume_hyper" step="1" min="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="productApplicationMethod">–ú–µ—Ç–æ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)</label>
                    <textarea id="productApplicationMethod" rows="2"
                        placeholder="–û–±—ã—á–Ω–æ–µ —Ä–∞–∑–≤–µ–¥–µ–Ω–∏–µ: N –ª–æ–∂–µ–∫ –Ω–∞ M –º–ª –≤–æ–¥—ã."></textarea>
                </div>

                <div class="form-group">
                    <label for="productDescription">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea id="productDescription" rows="3"
                        placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥—É–∫—Ç–µ"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>

            <hr>
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤</h3>
            <table id="productsTable" class="data-table">
                <thead>
                    <tr>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–ö–∫–∞–ª/100–≥</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="productsTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="initialData.js"></script>
    <script src="app.js"></script>
</body>

</html>